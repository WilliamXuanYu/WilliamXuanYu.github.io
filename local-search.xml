<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>知识图谱构建-Opennre上手体验</title>
    <link href="/2023/03/27/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E6%9E%84%E5%BB%BA-Opennre%E4%B8%8A%E6%89%8B%E4%BD%93%E9%AA%8C/"/>
    <url>/2023/03/27/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E6%9E%84%E5%BB%BA-Opennre%E4%B8%8A%E6%89%8B%E4%BD%93%E9%AA%8C/</url>
    
    <content type="html"><![CDATA[<blockquote><p>OpenNRE是一个用于关系抽取（Relation Extraction）的Python库。可以训练和评估多种关系抽取模型，并且支持多种数据集的使用。本篇博客包含OpenNRE库的简介和使用。<br>注意：下面所有全部基于Linux系统，使用Windows执行会报关于路径的错，可以通过修改路径完成任务，详细见github评论（但是我没有成功……）</p></blockquote><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>OpenNRE是由THUNLP组织开发的Python库，可以帮助实现关系抽取任务。该库提供了多个经典的关系抽取模型的实现，例如PCNN+ATT、PCNN+ONE、BERT等。同时，也提供了多种数据集的使用，包括NYT、Wiki等。OpenNRE库的目标是为研究人员和开发者提供一套通用的、易于使用的工具，用于解决关系抽取问题。</p><p>~github地址：<a href="https://github.com/thunlp/OpenNRE~">https://github.com/thunlp/OpenNRE~</a></p><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>下面将介绍OpenNRE库的使用步骤。</p><h2 id="1-安装OpenNRE"><a href="#1-安装OpenNRE" class="headerlink" title="1. 安装OpenNRE"></a>1. 安装OpenNRE</h2><p><strong>1.anaconda的安装</strong></p><p>略</p><p><strong>2.所需package的安装</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">pip install -r requirements.txt<br></code></pre></td></tr></table></figure><p><strong>3.克隆OpenNRE到本地</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">git clone https://github.com/thunlp/OpenNRE.git --depth 1<br></code></pre></td></tr></table></figure><p><strong>4.准备数据</strong></p><p>按要求创建data目录并下载提供的数据。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs text">cd OpenNRE<br>mkdir data<br>cd data<br>wget https://cloud.tsinghua.edu.cn/f/11391e48b72749d8b60a/?dl=1<br></code></pre></td></tr></table></figure><p>下载好后，解压并预处理。注意这里不要按照README.md做。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs text">mv index.html?dl=1 nyt.tar<br>tar -xvf nyt.tar<br>cd nyt<br>python2 protobuf2json.py .<br></code></pre></td></tr></table></figure><p>原README.md中的说明中generate Document_pb2.py 请<strong>务必不要</strong>执行。然后，运行protobuf2json.py时一定要用python2，并给入参数 “.” ，否则会报错。</p><p><strong>5.Run</strong></p><p>现在我们终于可以运行了(下面是一个训练用的demo)</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">cd ../..<br>python3 train_demo.py nyt pcnn att<br></code></pre></td></tr></table></figure><h2 id="2-准备数据集"><a href="#2-准备数据集" class="headerlink" title="2. 准备数据集"></a>2. 准备数据集</h2><p>OpenNRE库支持多种数据集的使用。可以从以下链接中下载数据集并解压到任意目录下：</p><ul><li>NYT数据集：<a href="https://drive.google.com/file/d/1E3lY-Mi-w0TQIyy-Q22TntCqRY3OGaZG/view?usp=sharing">https://drive.google.com/file/d/1E3lY-Mi-w0TQIyy-Q22TntCqRY3OGaZG/view?usp=sharing</a></li><li>Wiki数据集：<a href="https://drive.google.com/file/d/1GDX3qN3Qb_HzJ8WxpyTtTmZJ-3nq3JbF/view?usp=sharing">https://drive.google.com/file/d/1GDX3qN3Qb_HzJ8WxpyTtTmZJ-3nq3JbF/view?usp=sharing</a></li></ul><p>数据集的格式为：每行为一个关系实例，其中包含“实体1\t实体2\t关系类别”的三元组。例如：</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">Copy codeJohn LennonThe <span class="hljs-keyword">Beatles</span>Member_Of<br><span class="hljs-keyword">John </span>LennonImagineWriter_Of<br></code></pre></td></tr></table></figure><h2 id="3-训练模型"><a href="#3-训练模型" class="headerlink" title="3. 训练模型"></a>3. 训练模型</h2><p>OpenNRE库提供了多个经典的关系抽取模型的实现，例如PCNN+ATT、PCNN+ONE、BERT等。可以使用以下代码来训练一个PCNN+ATT模型：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs routeros">pythonCopy codefrom opennre import encoder, model, framework<br><span class="hljs-keyword">from</span> opennre.dataset import WikiDataset<br><br><span class="hljs-comment"># 准备数据集</span><br>train_data = WikiDataset(<span class="hljs-string">&#x27;./data/wiki/train.txt&#x27;</span>)<br>val_data = WikiDataset(<span class="hljs-string">&#x27;./data/wiki/val.txt&#x27;</span>)<br>test_data = WikiDataset(<span class="hljs-string">&#x27;./data/wiki/test.txt&#x27;</span>)<br><br><span class="hljs-comment"># 准备编码器</span><br>word_encoder = encoder.get_encoder(<span class="hljs-attribute">name</span>=<span class="hljs-string">&#x27;pcnn&#x27;</span>)<br><span class="hljs-comment"># 准备模型</span><br>model = model.get_model(<span class="hljs-attribute">name</span>=<span class="hljs-string">&#x27;pcnn_att&#x27;</span>, <br>                        <span class="hljs-attribute">word_encoder</span>=word_encoder,<br>                        <span class="hljs-attribute">num_classes</span>=train_data.num_classes,<br>                        <span class="hljs-attribute">rel2id</span>=train_data.rel2id)<br><span class="hljs-comment"># 准备框架</span><br>framework = framework.get_framework(<span class="hljs-attribute">name</span>=<span class="hljs-string">&#x27;pytorch&#x27;</span>)<br>trainer = framework.Trainer(<span class="hljs-attribute">model</span>=model, <span class="hljs-attribute">train</span>=train_data, <span class="hljs-attribute">val</span>=val_data, <span class="hljs-attribute">test</span>=test_data, <br>                            <span class="hljs-attribute">batch_size</span>=128, <span class="hljs-attribute">ckpt_path</span>=<span class="hljs-string">&#x27;./ckpt/wiki_pcnn_att.pkl&#x27;</span>, <span class="hljs-attribute">max_epoch</span>=10)<br>trainer.train_model()<br></code></pre></td></tr></table></figure><p>在训练过程中，可以通过修改<code>name</code>参数来切换不同的模型实现。例如，将<code>name</code>参数改为<code>bert_pcnn</code>即可切换到BERT+PCNN模型的训练。</p><h2 id="4-测试模型"><a href="#4-测试模型" class="headerlink" title="4. 测试模型"></a>4. 测试模型</h2><p>完成模型训练后，您可以使用以下代码来测试模型：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs routeros">pythonCopy codefrom opennre import encoder, model, framework<br><span class="hljs-keyword">from</span> opennre.dataset import WikiDataset<br><br><span class="hljs-comment"># 准备数据集</span><br>test_data = WikiDataset(<span class="hljs-string">&#x27;./data/wiki/test.txt&#x27;</span>)<br><br><span class="hljs-comment"># 准备编码器</span><br>word_encoder = encoder.get_encoder(<span class="hljs-attribute">name</span>=<span class="hljs-string">&#x27;pcnn&#x27;</span>)<br><span class="hljs-comment"># 准备模型</span><br>model = model.get_model(<span class="hljs-attribute">name</span>=<span class="hljs-string">&#x27;pcnn_att&#x27;</span>, <br>                        <span class="hljs-attribute">word_encoder</span>=word_encoder,<br>                        <span class="hljs-attribute">num_classes</span>=test_data.num_classes,<br>                        <span class="hljs-attribute">rel2id</span>=test_data.rel2id)<br><span class="hljs-comment"># 准备框架</span><br>framework = framework.get_framework(<span class="hljs-attribute">name</span>=<span class="hljs-string">&#x27;pytorch&#x27;</span>)<br>tester = framework.Tester(<span class="hljs-attribute">model</span>=model, <span class="hljs-attribute">data</span>=test_data, <span class="hljs-attribute">ckpt</span>=<span class="hljs-string">&#x27;./ckpt/wiki_pcnn_att.pkl&#x27;</span>)<br>tester.test()<br></code></pre></td></tr></table></figure><h1 id="预训练模型实验体验"><a href="#预训练模型实验体验" class="headerlink" title="预训练模型实验体验"></a>预训练模型实验体验</h1><p>这里使用预训练模型：wiki80_bert_softmax进行测试</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><br><span class="hljs-keyword">import</span> opennre<br><span class="hljs-keyword">import</span> jieba<br><span class="hljs-keyword">import</span> jieba.posseg <span class="hljs-keyword">as</span> pseg<br><span class="hljs-keyword">import</span> paddle<br><br>model = opennre.get_model(<span class="hljs-string">&#x27;wiki80_bert_softmax&#x27;</span>)<br><br>text = <span class="hljs-string">&quot;&quot;&quot;白鸽巢前地，是澳门圣安多尼堂区的广场，位于澳门半岛西北面，旧城区的北端。2005年开始，</span><br><span class="hljs-string">随澳门历史城区之一部份而被列入世界文化遗产名录内，为入选的8个古老广场之一。</span><br><span class="hljs-string">其名字源自十八世纪曾在此居住的葡萄牙富商马葵士有关，因马葵士所养白鸽栖于檐宇，远观像白鸽巢一样，故而得名。</span><br><span class="hljs-string">白鸽巢前地周边为葡萄牙人在澳门最早的居住区。在白鸽巢前地旁边，一同成为文化遗产的建筑有圣安多尼教堂、</span><br><span class="hljs-string">基督教坟场和东方基金会会址，其他古老名胜还有白鸽巢公园。</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-comment"># text的文字仅为截取，实际结果使用完整数据</span><br>text_copy = text<br><br>paddle.enable_static()<br>jieba.enable_paddle()<br>texts = pseg.cut(text,use_paddle = <span class="hljs-literal">True</span>)<br><br>Location = []<br><span class="hljs-keyword">for</span> text,flag <span class="hljs-keyword">in</span> texts:<br>    <span class="hljs-keyword">if</span> flag == <span class="hljs-string">&#x27;LOC&#x27;</span>:<br>        Location.append(text)<br><br>size = <span class="hljs-built_in">len</span>(Location)<br><br>h_text = <span class="hljs-built_in">str</span>(<span class="hljs-string">&quot;白鸽巢前地&quot;</span>)<br>t_text = <span class="hljs-built_in">str</span>(<span class="hljs-string">&quot;澳门圣安多尼堂区&quot;</span>)<br>h_pos = (text_copy.index(h_text), text_copy.index(h_text) + <span class="hljs-built_in">len</span>(h_text))<br>t_pos = (text_copy.index(t_text), text_copy.index(t_text) + <span class="hljs-built_in">len</span>(t_text))<br>x=model.infer(&#123;<span class="hljs-string">&#x27;text&#x27;</span>: text_copy, <span class="hljs-string">&#x27;h&#x27;</span>: &#123;<span class="hljs-string">&#x27;pos&#x27;</span>: h_pos&#125;, <span class="hljs-string">&#x27;t&#x27;</span>: &#123;<span class="hljs-string">&#x27;pos&#x27;</span>: t_pos&#125;&#125;)<br>t = [h_text,t_text,x[<span class="hljs-number">0</span>],x[<span class="hljs-number">1</span>]]<br><span class="hljs-built_in">print</span>(t)<br></code></pre></td></tr></table></figure><p>结果：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br></pre></td><td class="code"><pre><code class="hljs text">圣奥斯定教堂 圣奥斯定教堂 followed by<br>圣奥斯定教堂 意大利天主教 followed by<br>圣奥斯定教堂 1586年 followed by<br>圣奥斯定教堂 澳 followed by<br>圣奥斯定教堂 三年后 followed by<br>圣奥斯定教堂 葡国 followed by<br>圣奥斯定教堂 澳门 followed by<br>圣奥斯定教堂 澳门 followed by<br>圣奥斯定教堂 龙须庙 followed by<br>圣奥斯定教堂 龙嵩庙 followed by<br>圣奥斯定教堂 2005年 followed by<br>圣奥斯定教堂 澳门 followed by<br>东望洋炮台 东望洋山炮台 followed by<br>东望洋炮台 东望洋山 followed by<br>东望洋炮台 （松山 said to be the same as<br>东望洋炮台 澳门半岛 followed by<br>东望洋炮台 1637至1638年间 followed by<br>东望洋炮台 中国 followed by<br>东望洋炮台 澳门东 followed by<br>东望洋炮台 望洋山 followed by<br>东望洋炮台 。东望洋灯塔 followed by<br>东望洋炮台 东望洋炮台 followed by<br>东望洋炮台 东望洋山 followed by<br>东望洋炮台 1992年 followed by<br>东望洋炮台 澳门八景 followed by<br>东望洋炮台 2005年 followed by<br>东望洋炮台 澳门 followed by<br>东望洋灯塔 中国 followed by<br>东望洋灯塔 澳门东 followed by<br>东望洋灯塔 望洋山 followed by<br>东望洋灯塔 。东望洋灯塔 followed by<br>东望洋灯塔 东望洋炮台 followed by<br>东望洋灯塔 东望洋山 followed by<br>东望洋灯塔 1992年 followed by<br>东望洋灯塔 澳门八景 followed by<br>东望洋灯塔 2005年 followed by<br>东望洋灯塔 澳门 followed by<br>港务局大楼 澳门特别行政区 followed by<br>港务局大楼 内妈阁 followed by<br>港务局大楼 2005年 followed by<br>港务局大楼 澳门 followed by<br>圣安多尼教堂 圣安多尼教堂 followed by<br>圣安多尼教堂 澳门三大古教堂 followed by<br>圣安多尼教堂 澳门 followed by<br>圣安多尼教堂 1875年 followed by<br>圣安多尼教堂 1930年 followed by<br>圣安多尼教堂 今日 followed by<br>圣安多尼教堂 ，故教堂 followed by<br>圣安多尼教堂 “花王堂”。教堂 followed by<br>圣安多尼教堂 澳门 followed by<br>圣安多尼教堂 韩国 followed by<br>圣安多尼教堂 圣安多尼教堂 followed by<br>圣安多尼教堂 澳门三大古教堂 followed by<br>圣安多尼教堂 澳门 followed by<br>圣安多尼教堂 1565年 followed by<br>圣安多尼教堂 1875年 followed by<br>圣安多尼教堂 1930年 followed by<br>圣安多尼教堂 今日 followed by<br>圣安多尼教堂 “花王堂”。教堂 followed by<br>圣安多尼教堂 澳门 followed by<br>圣安多尼教堂 韩国 followed by<br>岗顶前地 澳门岗顶 followed by<br>岗顶前地 2005年 followed by<br>岗顶前地 澳门 followed by<br>岗顶前地 岗顶剧院 followed by<br>岗顶前地 伯多禄 followed by<br>岗顶前地 澳门岗顶 followed by<br>岗顶前地 古老剧院 followed by<br>岗顶前地 中国 followed by<br>岗顶前地 2005年 followed by<br>岗顶前地 澳门 followed by<br>岗顶前地 岗顶剧院 followed by<br>岗顶前地 伯多禄 followed by<br>岗顶前地 澳门岗顶 followed by<br>岗顶前地 古老剧院 followed by<br>岗顶前地 中国 followed by<br>圣老楞佐教堂 澳门 followed by<br>圣老楞佐教堂 风顺堂街，澳门慈幼中学 followed by<br>圣老楞佐教堂 1569年间 followed by<br>圣老楞佐教堂 耶稣会 followed by<br>圣老楞佐教堂 1618年 followed by<br>圣老楞佐教堂 1844年 followed by<br>白鸽巢公园 澳门圣安多尼堂区 followed by<br>白鸽巢公园 贾梅士 followed by<br>白鸽巢公园 400多年前 followed by<br>白鸽巢公园 石洞 followed by<br>白鸽巢公园 葡国 followed by<br>白鸽巢公园 贾梅士（ followed by<br>白鸽巢公园 路易斯德 followed by<br>白鸽巢公园 贾梅士）。 followed by<br>白鸽巢公园 200多年前 followed by<br>白鸽巢公园 贾梅士 followed by<br>白鸽巢公园 澳门 followed by<br>白鸽巢公园 澳门 followed by<br>白鸽巢公园 。贾梅士博物院 followed by<br>白鸽巢公园 19世纪 followed by<br>白鸽巢公园 葡萄牙 followed by<br>白鸽巢公园 马葵士 followed by<br>白鸽巢公园 马葵士 followed by<br>白鸽巢公园 澳门 followed by<br>白鸽巢公园 澳门圣安多尼堂区 followed by<br>白鸽巢公园 澳门半岛西北 followed by<br>白鸽巢公园 旧城区 followed by<br>白鸽巢公园 2005年 followed by<br>白鸽巢公园 澳门 followed by<br>白鸽巢公园 十八世纪 followed by<br>白鸽巢公园 葡萄牙 followed by<br>白鸽巢公园 马葵士 followed by<br>白鸽巢公园 马葵士 followed by<br>白鸽巢公园 葡萄牙 followed by<br>白鸽巢公园 澳门 followed by<br>白鸽巢公园 圣安多尼教堂 followed by<br>白鸽巢公园 基督教 followed by<br>白鸽巢公园 东方基金会 followed by<br>仁慈堂大楼 澳门议事亭 followed by<br>仁慈堂大楼 仁慈堂 followed by<br>仁慈堂大楼 澳门慈善机构仁慈堂 followed by<br>仁慈堂大楼 。仁慈堂博物馆 followed by<br>仁慈堂大楼 2001年12月14日 followed by<br>仁慈堂大楼 仁慈堂值理会 followed by<br>仁慈堂大楼 安达 followed by<br>仁慈堂大楼 天主教 followed by<br>仁慈堂大楼 天主教 followed by<br>仁慈堂大楼 亚洲地区 followed by<br>仁慈堂大楼 仁慈堂 followed by<br>仁慈堂大楼 仁慈堂 followed by<br>仁慈堂大楼 澳门 followed by<br>妈祖阁 湄洲湾北岸山亭镇 followed by<br>妈祖阁 山柄村 followed by<br>妈祖阁 三月廿三 followed by<br>妈祖阁 澳门妈阁庙 followed by<br>妈祖阁 澳门 followed by<br>妈祖阁 1488年 followed by<br>妈祖阁 五百多年 followed by<br>妈祖阁 妈阁庙 followed by<br>妈祖阁 澳门 followed by<br>妈祖阁 西南方，枕山 followed by<br>妈祖阁 临海 followed by<br>妈祖阁 弘仁殿 followed by<br>妈祖阁 观音阁 followed by<br>妈祖阁 道教 followed by<br>妈祖阁 祖， followed by<br>妈祖阁 福建 followed by<br>妈祖阁 2005年7月15日 followed by<br>妈祖阁 南非 followed by<br>妈祖阁 德班市 followed by<br>妈祖阁 世界遗产委员会 followed by<br>妈祖阁 妈阁庙 followed by<br>妈祖阁 澳门 followed by<br>妈祖阁 澳门半岛西望洋山 followed by<br>妈祖阁 路德圣母岩洞。站 followed by<br>妈祖阁 望洋山 followed by<br>大三巴牌坊 澳门 followed by<br>大三巴牌坊 1580年 followed by<br>大三巴牌坊 圣保禄大教堂 followed by<br>大三巴牌坊 欧洲 followed by<br>大三巴牌坊 东方建筑 followed by<br>大三巴牌坊 澳门 followed by<br>大三巴牌坊 大三巴牌坊 followed by<br>大三巴牌坊 斜巷 followed by<br>大三巴牌坊 茨林 followed by<br>大三巴牌坊 澳门 followed by<br>大三巴牌坊 哪吒庙 followed by<br>大三巴牌坊 大三巴哪吒庙 followed by<br>大三巴牌坊 澳门 followed by<br>大三巴牌坊 2005年 followed by<br>大三巴牌坊 澳门 followed by<br>大三巴牌坊 澳门 followed by<br>大三巴牌坊 1580年 followed by<br>大三巴牌坊 圣保禄大教堂 followed by<br>大三巴牌坊 欧洲 followed by<br>大三巴牌坊 东方建筑 followed by<br>板樟堂前地 澳门半岛市中心 followed by<br>板樟堂前地 2005年 followed by<br>板樟堂前地 澳门 followed by<br>板樟堂前地 1990年代 followed by<br>板樟堂前地 板樟堂街 followed by<br>板樟堂前地 澳门半岛 followed by<br>板樟堂前地 板樟堂 followed by<br>板樟堂前地 ，东 followed by<br>板樟堂前地 伯多禄局 followed by<br>板樟堂前地 1869年7月 followed by<br>板樟堂前地 澳门 followed by<br>板樟堂前地 澳门半岛中区 followed by<br>板樟堂前地 澳门四大广场 followed by<br>板樟堂前地 2005年 followed by<br>板樟堂前地 澳门 followed by<br>板樟堂前地 新马路，南 followed by<br>东方基金会会址 澳门圣安多尼堂区 followed by<br>东方基金会会址 澳门半岛西北 followed by<br>东方基金会会址 旧城区 followed by<br>东方基金会会址 2005年 followed by<br>东方基金会会址 澳门 followed by<br>东方基金会会址 十八世纪 followed by<br>东方基金会会址 葡萄牙 followed by<br>东方基金会会址 马葵士 followed by<br>东方基金会会址 马葵士 followed by<br>东方基金会会址 葡萄牙 followed by<br>东方基金会会址 澳门 followed by<br>东方基金会会址 圣安多尼教堂 followed by<br>东方基金会会址 基督教 followed by<br>东方基金会会址 东方基金会 followed by<br>主教座堂 望德圣母堂 followed by<br>主教座堂 澳门 followed by<br>主教座堂 澳门 followed by<br>主教座堂 座堂， followed by<br>主教座堂 澳门教区 followed by<br>主教座堂 座堂。 followed by<br>主教座堂 澳 followed by<br>主教座堂 望德堂 followed by<br>主教座堂 ，望德堂 followed by<br>主教座堂 澳门天主教 followed by<br>主教座堂 澳门 followed by<br>主教座堂 大庙 followed by<br>主教座堂 1567年 followed by<br>大炮台 圣保禄炮台 followed by<br>大炮台 三巴炮台 followed by<br>大炮台 大三巴牌坊 followed by<br>大炮台 澳门 followed by<br>大炮台 澳门 followed by<br>大炮台 圣安多尼堂区 followed by<br>大炮台 花王堂区 followed by<br>大炮台 澳门半岛 followed by<br>大炮台 澳门半岛西部 followed by<br>大炮台 东、南 followed by<br>大炮台 大马路 followed by<br>大炮台 玛堂区 followed by<br>大炮台 、望德堂区 followed by<br>大炮台 、大堂区 followed by<br>大炮台 玛堂区 followed by<br>大炮台 澳之冠 followed by<br>大炮台 1996年 followed by<br>大炮台 新桥 followed by<br>大炮台 大三巴牌坊、大炮台 followed by<br>大炮台 、白鸪巢公园 followed by<br>大炮台 大炮台 followed by<br>大炮台 圣保禄炮台 followed by<br>大炮台 大三巴炮台。大炮台 followed by<br>大炮台 大三巴牌坊 followed by<br>大炮台 澳门 followed by<br>大炮台 公元1616年 followed by<br>大炮台 圣保禄教堂 followed by<br>大炮台 耶稣会 followed by<br>大炮台 现在 followed by<br>大炮台 大炮台山 followed by<br>大炮台 中国 followed by<br>大炮台 澳门半岛 followed by<br>大炮台 柿山， followed by<br>大炮台 澳门半岛中央柿山 followed by<br>大炮台 ，原 followed by<br>大炮台 圣保罗教堂 followed by<br>大炮台 圣保罗炮台 followed by<br>大炮台 大三巴 followed by<br>大炮台 澳门 followed by<br>议事亭前地 澳门 followed by<br>议事亭前地 澳门半岛中区 followed by<br>议事亭前地 澳门四大广场 followed by<br>议事亭前地 2005年 followed by<br>议事亭前地 澳门 followed by<br>议事亭前地 新马路，南 followed by<br>圣若瑟修院 圣若瑟修院 followed by<br>圣若瑟修院 澳门岗顶 followed by<br>圣若瑟修院 何东图书馆 followed by<br>圣若瑟修院 圣保禄学院 followed by<br>圣若瑟修院 中国 followed by<br>圣若瑟修院 耶稣会修院 followed by<br>圣若瑟修院 澳门岗顶 followed by<br>圣若瑟修院 2005年 followed by<br>圣若瑟修院 澳门 followed by<br>何东图书馆 圣若瑟修院 followed by<br>何东图书馆 圣保禄学院 followed by<br>何东图书馆 中国 followed by<br>何东图书馆 澳门中央图书馆 followed by<br>何东图书馆 一八九五年 followed by<br>何东图书馆 澳门公共图书馆 followed by<br>何东图书馆 一八七三年 followed by<br>何东图书馆 澳门图书馆 followed by<br>何东图书馆 澳门公共图书馆 followed by<br>何东图书馆 澳门公共图书馆 followed by<br>玫瑰堂 玫瑰堂玫瑰堂 followed by<br>玫瑰堂 玫瑰圣母堂 followed by<br>玫瑰堂 圣多明 followed by<br>玫瑰堂 澳门 followed by<br>玫瑰堂 1587年 followed by<br>玫瑰堂 西班牙 followed by<br>玫瑰堂 圣多明 followed by<br>玫瑰堂 葡萄牙 followed by<br>玫瑰堂 17世纪 followed by<br>玫瑰堂 1874年 followed by<br>玫瑰堂 现在 followed by<br>玫瑰堂 玫瑰堂 followed by<br>玫瑰堂 玫瑰圣母堂 followed by<br>玫瑰堂 圣多明 followed by<br>玫瑰堂 澳门 followed by<br>玫瑰堂 400多年 followed by<br>玫瑰堂 旧圣道明会院 followed by<br>亚婆井前地 澳门西望洋山 followed by<br>亚婆井前地 澳门建筑、 followed by<br>亚婆井前地 2005年 followed by<br>亚婆井前地 澳门 followed by<br>大堂前地 望德圣母堂 followed by<br>大堂前地 澳门 followed by<br>大堂前地 澳门 followed by<br>大堂前地 座堂， followed by<br>大堂前地 澳门教区 followed by<br>大堂前地 座堂。 followed by<br>大堂前地 澳 followed by<br>大堂前地 望德堂 followed by<br>大堂前地 ，望德堂 followed by<br>大堂前地 澳门天主教 followed by<br>大堂前地 澳门 followed by<br>大堂前地 大庙 followed by<br>大堂前地 1567年 followed by<br>卢家大屋 澳门卢家大屋 followed by<br>卢家大屋 大堂巷七号 followed by<br>卢家大屋 大堂巷的卢家大屋 followed by<br>卢家大屋 澳门 followed by<br>卢家大屋 卢华绍 followed by<br>卢家大屋 卢九） followed by<br>卢家大屋 光绪十五年 followed by<br>卢家大屋 广东 followed by<br>卢家大屋 新会 followed by<br>卢家大屋 咸丰六年 followed by<br>卢家大屋 1857年 followed by<br>卢家大屋 澳门 followed by<br>卢家大屋 澳门 followed by<br>卢家大屋 ，雄财 followed by<br>卢家大屋 澳门 followed by<br>卢家大屋 卢九街 followed by<br>卢家大屋 卢华绍 followed by<br>基督教坟场 澳门圣安多尼堂区 followed by<br>基督教坟场 澳门半岛西北 followed by<br>基督教坟场 旧城区 followed by<br>基督教坟场 2005年 followed by<br>基督教坟场 澳门 followed by<br>基督教坟场 十八世纪 followed by<br>基督教坟场 葡萄牙 followed by<br>基督教坟场 马葵士 followed by<br>基督教坟场 马葵士 followed by<br>基督教坟场 葡萄牙 followed by<br>基督教坟场 澳门 followed by<br>基督教坟场 圣安多尼教堂 followed by<br>基督教坟场 基督教 followed by<br>基督教坟场 东方基金会 followed by<br>基督教坟场 赖廉士 followed by<br>基督教坟场 1898年10月10日 followed by<br>基督教坟场 1977年10月17日 followed by<br>基督教坟场 澳洲 followed by<br>基督教坟场 香港生理学家、军人和大学 followed by<br>基督教坟场 1949年 followed by<br>基督教坟场 1964年 followed by<br>基督教坟场 香港大学 followed by<br>基督教坟场 1919年 followed by<br>基督教坟场 墨尔本大学 followed by<br>基督教坟场 1922年 followed by<br>基督教坟场 罗德 followed by<br>基督教坟场 牛津大学 followed by<br>基督教坟场 1928年起 followed by<br>基督教坟场 香港大学生理学系主任、香港大学医学院 followed by<br>基督教坟场 香港政府医务委员会 followed by<br>基督教坟场 1941年12月 followed by<br>基督教坟场 香港 followed by<br>基督教坟场 1月 followed by<br>基督教坟场 同年 followed by<br>基督教坟场 7月 followed by<br>基督教坟场 广东 followed by<br>基督教坟场 曲江 followed by<br>基督教坟场 韶关市 followed by<br>基督教坟场 华南地区 followed by<br>基督教坟场 香港 followed by<br>基督教坟场 香港 followed by<br>基督教坟场 香港大学 followed by<br>基督教坟场 1949年 followed by<br>基督教坟场 1964年间 followed by<br>基督教坟场 港大 followed by<br>基督教坟场 任内 followed by<br>基督教坟场 1961年 followed by<br>基督教坟场 1941年 followed by<br>基督教坟场 香港 followed by<br>基督教坟场 澳门 followed by<br>基督教坟场 基督教 followed by<br>基督教坟场 赖廉士 followed by<br>基督教坟场 1942年 followed by<br>基督教坟场 1944年 followed by<br>基督教坟场 1962年 followed by<br>基督教坟场 1965年 followed by<br>基督教坟场 香港大学 followed by<br>基督教坟场 董， followed by<br>基督教坟场 港大 followed by<br>基督教坟场 任内 followed by<br>岗顶剧院 岗顶剧院 followed by<br>岗顶剧院 伯多禄 followed by<br>岗顶剧院 澳门岗顶 followed by<br>岗顶剧院 古老剧院 followed by<br>岗顶剧院 中国 followed by<br>岗顶剧院 2005年 followed by<br>岗顶剧院 澳门 followed by<br>岗顶剧院 岗顶剧院 followed by<br>岗顶剧院 伯多禄 followed by<br>岗顶剧院 澳门岗顶 followed by<br>岗顶剧院 中国 followed by<br>哪吒庙 大三巴牌坊 followed by<br>哪吒庙 哪吒庙 followed by<br>哪吒庙 大三巴哪吒庙 followed by<br>哪吒庙 澳门 followed by<br>哪吒庙 大三巴牌坊 followed by<br>哪吒庙 斜巷 followed by<br>哪吒庙 茨林 followed by<br>哪吒庙 澳门 followed by<br>哪吒庙 哪吒庙 followed by<br>哪吒庙 大三巴哪吒庙 followed by<br>哪吒庙 澳门 followed by<br>哪吒庙 2005年 followed by<br>哪吒庙 澳门 followed by<br>哪吒庙 旧城墙遗址 followed by<br>哪吒庙 大三巴 followed by<br>哪吒庙 哪吒庙 followed by<br>哪吒庙 澳门 followed by<br>哪吒庙 澳门 followed by<br>哪吒庙 2005年 followed by<br>哪吒庙 澳门 followed by<br>哪吒庙 澳门建筑城墙 followed by<br>哪吒庙 1569年 followed by<br>哪吒庙 1604年 followed by<br>哪吒庙 中国政府 followed by<br>哪吒庙 明朝 followed by<br>哪吒庙 1617年 followed by<br>哪吒庙 中国 followed by<br>哪吒庙 1625年 followed by<br>哪吒庙 1632年 followed by<br>哪吒庙 澳门城市图 followed by<br>哪吒庙 澳门城 followed by<br>哪吒庙 澳门城 followed by<br>哪吒庙 旧城墙遗址 followed by<br>哪吒庙 柿山 followed by<br>哪吒庙 哪吒古庙 followed by<br>哪吒庙 澳门 followed by<br>哪吒庙 柿山 followed by<br>哪吒庙 哪吒庙， followed by<br>哪吒庙 澳门 followed by<br>哪吒庙 哪吒 followed by<br>哪吒庙 每年 followed by<br>哪吒庙 5月18日 followed by<br>哪吒庙 哪吒 followed by<br>哪吒庙 柿山 followed by<br>哪吒庙 哪吒古庙 followed by<br>哪吒庙 澳门 followed by<br>哪吒庙 柿山 followed by<br>哪吒庙 哪吒古庙 followed by<br>哪吒庙 哪吒庙 followed by<br>哪吒庙 澳门 followed by<br>哪吒庙 大三巴牌坊 followed by<br>哪吒庙 哪吒庙 followed by<br>哪吒庙 哪吒 followed by<br>哪吒庙 哪吒庙 followed by<br>哪吒庙 哪吒 followed by<br>哪吒庙 澳门电业工会 followed by<br>哪吒庙 1956年 followed by<br>哪吒庙 会址 followed by<br>哪吒庙 哪吒庙 followed by<br>哪吒庙 澳门电业 followed by<br></code></pre></td></tr></table></figure><blockquote><p>不知道是不是这个模型收到英文语境影响，属性多为followed by</p></blockquote><p>这里使用预训练模型：cnn进行测试</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs text">东望洋炮台 东望洋山炮台 owned by<br>东望洋炮台 东望洋山 owned by<br>岗顶前地 岗顶剧院 owned by<br>岗顶前地 岗顶剧院 has part<br>白鸽巢公园 。贾梅士博物院 said to be the same as<br>大三巴牌坊 大三巴哪吒庙 owned by<br>板樟堂前地 板樟堂街 owned by<br>板樟堂前地 板樟堂 owned by<br>主教座堂 望德圣母堂 owned by<br>主教座堂 澳门 has part<br>大炮台 圣安多尼堂区 has part<br>何东图书馆 圣若瑟修院 owned by<br>何东图书馆 澳门中央图书馆 has part<br>何东图书馆 一八九五年 has part<br>大堂前地 望德圣母堂 owned by<br>大堂前地 澳门 has part<br>卢家大屋 澳门卢家大屋 has part<br>卢家大屋 澳门 has part<br>卢家大屋 澳门 has part<br>卢家大屋 澳门 has part<br>卢家大屋 澳门 has part<br>基督教坟场 赖廉士 has part<br>基督教坟场 赖廉士 has part<br>哪吒庙 大三巴哪吒庙 has part<br>哪吒庙 大三巴哪吒庙 has part<br>哪吒庙 澳门电业工会 owned by<br>哪吒庙 澳门电业 owned by<br></code></pre></td></tr></table></figure><blockquote><p>属性还是英文，但是好多了……（注意这里筛选了一定准确率的数据）</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>知识图谱</tag>
      
      <tag>Opennre</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>应用spacy的中文分词尝试</title>
    <link href="/2023/01/10/%E5%BA%94%E7%94%A8spacy%E7%9A%84%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D%E5%B0%9D%E8%AF%95/"/>
    <url>/2023/01/10/%E5%BA%94%E7%94%A8spacy%E7%9A%84%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D%E5%B0%9D%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<h1 id="一、安装-SpaCy"><a href="#一、安装-SpaCy" class="headerlink" title="一、安装 SpaCy"></a>一、安装 <a href="https://so.csdn.net/so/search?q=SpaCy&amp;spm=1001.2101.3001.7020">SpaCy</a></h1><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">pip <span class="hljs-keyword">install</span> spacy<br></code></pre></td></tr></table></figure><h1 id="二、英文分词"><a href="#二、英文分词" class="headerlink" title="二、英文分词"></a>二、英文分词</h1><ol><li>安装英文库</li></ol><hr><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> -<span class="hljs-keyword">m</span> spacy download <span class="hljs-keyword">en</span><br></code></pre></td></tr></table></figure><ol><li>分词</li></ol><hr><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">import</span> spacy<br><br>spacy_en = spacy.<span class="hljs-keyword">load</span>(&quot;en_core_web_sm&quot;)<br><br>def tokenize_en(<span class="hljs-type">text</span>):<br>    <span class="hljs-keyword">return</span> [tok.text <span class="hljs-keyword">for</span> tok <span class="hljs-keyword">in</span> spacy_en.tokenizer(<span class="hljs-type">text</span>)]<br><br>print(tokenize_en(&quot;Hello, my name is tom.&quot;))<br></code></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scheme">[<span class="hljs-symbol">&#x27;Hello</span>&#x27;, &#x27;,&#x27;, <span class="hljs-symbol">&#x27;my</span>&#x27;, <span class="hljs-symbol">&#x27;name</span>&#x27;, <span class="hljs-symbol">&#x27;is</span>&#x27;, <span class="hljs-symbol">&#x27;tom</span>&#x27;, <span class="hljs-symbol">&#x27;.</span>&#x27;]<br></code></pre></td></tr></table></figure><h1 id="三、中文分词"><a href="#三、中文分词" class="headerlink" title="三、中文分词"></a>三、中文分词</h1><ol><li>安装中文库</li></ol><hr><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">python -m spacy download zh_core_web_sm</span><br></code></pre></td></tr></table></figure><ol><li>分词</li></ol><hr><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">import</span> spacy<br><br>spacy_zh = spacy.<span class="hljs-keyword">load</span>(&quot;zh_core_web_sm&quot;)<br><br><br>def tokenize_zh(<span class="hljs-type">text</span>):<br>    <span class="hljs-keyword">return</span> [tok.text <span class="hljs-keyword">for</span> tok <span class="hljs-keyword">in</span> spacy_zh.tokenizer(<span class="hljs-type">text</span>)]<br><br><br>print(tokenize_zh(&quot;你好，我的名字叫汤姆&quot;))<br></code></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scheme">[<span class="hljs-symbol">&#x27;你好</span>&#x27;, <span class="hljs-symbol">&#x27;，</span>&#x27;, <span class="hljs-symbol">&#x27;我</span>&#x27;, <span class="hljs-symbol">&#x27;的</span>&#x27;, <span class="hljs-symbol">&#x27;名字</span>&#x27;, <span class="hljs-symbol">&#x27;叫</span>&#x27;, <span class="hljs-symbol">&#x27;汤姆</span>&#x27;]<br></code></pre></td></tr></table></figure><p>官网上提供有三个中文模型：<br>zh_core_web_sm<br>zh_core_web_md<br>zh_core_web_lg</p><p>安装方式：</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mel"><span class="hljs-keyword">python</span> -m spacy download zh_core_web_sm<br><span class="hljs-keyword">python</span> -m spacy download zh_core_web_md<br><span class="hljs-keyword">python</span> -m spacy download zh_core_web_lg<br></code></pre></td></tr></table></figure><h1 id="四、解析"><a href="#四、解析" class="headerlink" title="四、解析"></a>四、解析</h1><p>运行下列程序：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">text = <span class="hljs-string">&quot;The rain in Spain falls mainly on the plain.&quot;</span><br>doc = nlp(text)<br><br><span class="hljs-keyword">for</span> token <span class="hljs-keyword">in</span> doc:    <br>    <span class="hljs-built_in">print</span>(token.text, token.lemma_, token.pos_, token.is_stop)<br></code></pre></td></tr></table></figure><p>输出：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">The the DET Truerain <br>rain NOUN Falsein <br><span class="hljs-keyword">in</span> ADP TrueSpain <br>Spain PROPN <span class="hljs-literal">False</span><br>falls fall VERB Falsemainly <br>mainly ADV <span class="hljs-literal">False</span><br>on on ADP <span class="hljs-literal">True</span><br>the the DET Trueplain <br>plain NOUN <span class="hljs-literal">False</span><br>. . PUNCT <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure><p>解析：</p><p><img src="https://image.jiqizhixin.com/uploads/editor/8743cf1b-ff7f-4ef1-bb13-55296039da5e/640.png" alt="img"></p><ul><li>文本</li><li>词根</li><li>位置</li><li>词性（按上述表格顺序）<ul><li>限定词</li><li>名词</li><li>附加</li><li>专有名词</li><li>动词</li><li>副词</li><li>附加</li><li>限定词</li><li>名词</li><li>标点</li></ul></li><li>停用词</li></ul><p><img src="https://picture-for-mark.oss-cn-hangzhou.aliyuncs.com/img/202301101934684.png" alt="img"></p><h1 id="五、实际处理"><a href="#五、实际处理" class="headerlink" title="五、实际处理"></a>五、实际处理</h1><h2 id="英文"><a href="#英文" class="headerlink" title="英文"></a>英文</h2><p>可以利用string 去除标点，set 去重</p><p>该nlp变量现在是您通向所有spaCy的入口，并装载了en_core_web_sm英文模型</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> spacy<br>nlp = spacy.load(<span class="hljs-string">&#x27;en_core_web_sm&#x27;</span>) <span class="hljs-comment">#加载spacy</span><br>txt = <span class="hljs-string">&quot;A magnetic monopole is a hypothetical elementary particle.&quot;</span><br>doc = nlp(txt) <span class="hljs-comment"># 这里的doc是spaCy中的一种数据结构</span><br>list1=[]<br><span class="hljs-keyword">for</span> token <span class="hljs-keyword">in</span> doc:<br>    token=token.lemma_   <span class="hljs-comment">#词干化</span><br>    <span class="hljs-keyword">if</span> token <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> string.punctuation: <span class="hljs-comment">#去除所有标点</span><br>        list1.append(token)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">set</span>(list1))<br></code></pre></td></tr></table></figure><p><img src="https://picture-for-mark.oss-cn-hangzhou.aliyuncs.com/img/202301101917153.png" alt="image-20230110191710080"></p><h2 id="中文"><a href="#中文" class="headerlink" title="中文"></a>中文</h2><p>中文下不必进行词根处理（强行使用token=token.lemma_操作会报错）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> spacy<br><br>nlp = spacy.load(<span class="hljs-string">&#x27;zh_core_web_sm&#x27;</span>) <span class="hljs-comment">#加载spacy</span><br>txt = <span class="hljs-string">&quot;你好，我的名字叫汤姆&quot;</span><br>doc = nlp(txt)<br><br>list1=[]<br><span class="hljs-keyword">for</span> token <span class="hljs-keyword">in</span> doc:<br>    <span class="hljs-keyword">if</span> token.is_stop == <span class="hljs-literal">False</span>: <span class="hljs-comment">#去除停用词</span><br>        list1.append(token)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">set</span>(list1)) <span class="hljs-comment">#去重</span><br></code></pre></td></tr></table></figure><p><img src="https://picture-for-mark.oss-cn-hangzhou.aliyuncs.com/img/202301101938768.png" alt="image-20230110193842741"></p><h2 id="实际数据"><a href="#实际数据" class="headerlink" title="实际数据"></a>实际数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> spacy<br><br>nlp = spacy.load(<span class="hljs-string">&#x27;zh_core_web_sm&#x27;</span>) <span class="hljs-comment">#加载spacy</span><br>txt = <span class="hljs-string">&quot;一直认为法国菜吃的是精致，而意大利菜吃的就是气氛。喜欢分享，是意大利餐饮文化的精髓，所以用餐时那氛围就感觉比较轻松，最适合朋友和家庭聚会。&quot;</span> \<br>      <span class="hljs-string">&quot;这天，苏苏与朋友们来到澳门银河酒店的庭园意大利餐厅聚一聚。&quot;</span> \<br>      <span class="hljs-string">&quot;餐厅在酒店2楼，在东翼的贵宾大堂入口旁就有升降机直接到达，踏出升降机，走进一道非常漂亮的走廊。&quot;</span> \<br>      <span class="hljs-string">&quot;在这里打卡很不错。&quot;</span> \<br>      <span class="hljs-string">&quot;走到尽头就看见了漂亮的餐厅入口。&quot;</span> \<br>      <span class="hljs-string">&quot;装潢是典雅华丽的意大利风格，空间感很充足。&quot;</span> \<br>      <span class="hljs-string">&quot;厨房是开放式的，让客人可以欣赏大厨们的厨艺。&quot;</span> \<br>      <span class="hljs-string">&quot;苏苏已经看过很多次了，所以跟好友在餐桌上小酌一杯。餐厅有个藏酒库，有不少美酒在内，有兴趣可以问服务员拿酒单的。&quot;</span> \<br>      <span class="hljs-string">&quot;蕃茄香草面包&quot;</span> \<br>      <span class="hljs-string">&quot;餐厅自家制的面包，口感松软，香气四溢，用橄榄油和意大利黑醋同吃，滋味满腔。我们还在等两个朋友，一边小酌一边吃面包，不知不觉，我俩将整盆吃掉了。&quot;</span> \<br>      <span class="hljs-string">&quot;朋友们来了，可以起菜啦。&quot;</span> \<br>      <span class="hljs-string">&quot;火箭菜沙律&quot;</span> \<br>      <span class="hljs-string">&quot;苏苏超爱吃火箭菜(也称为芝麻菜)沙律，看着服务员在我们面前制作沙律，感觉特别新鲜，还有即切的芝士，看着时口水在心中一直流.....尝起来口感脆脆的火箭菜带点独有香气，还有橄榄油和柠檬汁等调味料搭配，十分开胃，可以为之后的美食作准备。&quot;</span> \<br>      <span class="hljs-string">&quot;黑毛猪火腿配意大利甜蜜&quot;</span> \<br>      <span class="hljs-string">&quot;毛猪火腿充满甘香、油香和果香，味道浓郁，是苏苏很爱的其中一种食材，这道配上意大利超甜蜜瓜，吃在口中，那种咸甜交错的滋味，幸福感满满的。&quot;</span> \<br>      <span class="hljs-string">&quot;芝士肉肠开心果薄饼&quot;</span> \<br>      <span class="hljs-string">&quot;在意大利餐厅用餐，绝对不能错过经典的披萨。&quot;</span> \<br>      <span class="hljs-string">&quot;除了披萨上的芝士和肉肠很好吃外，还有苏苏未在披萨里吃过的开心果碎，配搭真的很新鲜。披萨皮的部份更是让苏苏回味，它是薄皮的但有嚼劲Q感的手工皮披萨，面团很香，边是脆脆的，苏苏忍不住口，一口气吃了两件。&quot;</span> \<br>      <span class="hljs-string">&quot;章鱼土豆&quot;</span> \<br>      <span class="hljs-string">&quot;好吃的章鱼是来自意大利的，触手上的吸盘有两排，只有一排吸盘的，口感没有意大利沿岸生长的章鱼好吃。而这份章鱼就是有两排吸盘的，而且烹调得宜，口感软糯，搭配土豆的香味和伴吃的酱汁，好吃。&quot;</span> \<br>      <span class="hljs-string">&quot;战斧牛扒&quot;</span> \<br>      <span class="hljs-string">&quot;位于牛的上肋部连骨的肉扒，长长的骨头似印弟安战斧，故此得名。&quot;</span> \<br>      <span class="hljs-string">&quot;苏苏是牛魔王，很爱吃牛，特别是战斧牛扒，因为牛骨中的骨髓和脂肪加强了牛肉的味道，骨肉相连间的骨胶原能保持肉质湿润软滑，加上大型牛骨帮助固定牛扒形状，肉汁不会在牛扒熟成及烹调时因缩水而流失，味道更浓更集中。&quot;</span> \<br>      <span class="hljs-string">&quot;这一份大厨在烹调时火喉控制得宜，肉质口感嫩滑，牛肉味浓郁，十分好吃。&quot;</span> \<br>      <span class="hljs-string">&quot;拉米苏Tiramisu&quot;</span> \<br>      <span class="hljs-string">&quot;甜品一定要推介现场做的提拉米苏，苦与甜的平衡度恰到好处，还有可以欣赏专业人员在你面前现场调制，已经是值回票价。&quot;</span><br>doc = nlp(txt)<br><br>list1=[]<br><span class="hljs-keyword">for</span> token <span class="hljs-keyword">in</span> doc:<br>    <span class="hljs-keyword">if</span> token.is_stop == <span class="hljs-literal">False</span>: <span class="hljs-comment">#去除停用词</span><br>        list1.append(token)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">set</span>(list1))<br></code></pre></td></tr></table></figure><p>输出：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;浓郁, 苏苏, 甜, 人员, 小酌, 值回, 整盆, 起菜, 火箭, 伴吃, 牛, 漂亮, 道, 入口, 餐厅, 肉质, 披萨, 吃, 两, 现场, 朋友们, 口感, 菜, 银河, 搭配, 餐厅, 好吃, 入口, 升降机, 蜜瓜, 肠开, 时, 牛肉味, 榄油, 触手, 生长, 苏苏, 得宜, 意大利, 升降机, 苏苏, 口中, 流失, 满满, 香草, 好吃, 做, 面包, 家庭, 吸盘, 澳门, 甜蜜, 贵宾大堂, 形状, 超甜, 烹调, 交错, 浓, 烹调, 用橄, 满腔, 章鱼, 沿岸, 庭园, 黑毛, <span class="hljs-number">2</span>楼, 甘香, 大型, 得宜, 蕃茄, 松软, 黑醋, 吃, 章鱼, 吸盘, 餐饮, 氛围, 调味料, 来到, 大利, 味道, 果香, 肉质, 牛扒, 小酌, 服务员, 自家制, 面团, 苏苏忍, 精致, 喜欢, 口感, 轻松, 这天, 开胃, 战斧, 脂肪, 充满, 间, 苏苏, 餐厅, 回味, Q感, 一口气, 菜吃, 意大利, 菜带, 爱, 牛骨, 配意, 固定, 果碎, 部份, 问, 薄皮, 特别, 精髓, 苏苏, 相连, 里, 苏苏, 嚼劲, 芝麻, 面前, 意大利, 即切, 心中, 连骨, 火箭, 安战斧, 典雅, 牛肉, 欣赏, 开心, 专业, 吃, 感觉, 位于, 尝, 长长, 不错, 餐厅, 风格, 意大利, 厨艺, 肉肠, 披萨, 恰到好处, 真的, 面前, 火箭, 称为, 肋部, 踏出, 印弟, 肉, 充足, 披萨, 甜品, 苦, 欣赏, 我俩, 超爱, 章鱼, 烹调, 香味, 牛扒, 一道, 幸福感, 意大利, 经典, 现场, 平衡度, 吃, 好吃, 排, 软糯, 聚, 酱汁, 走廊, 意大利, 尽头, 咸甜, 芝士, 嫩滑, 苏Tiramisu, 滋味, 朋友, 意大利, 苏苏, 份, 酒店, 走进, 食材, 打卡, 吃, 缩水, 薄饼, 控制, 口感, 推介, 意大利, 吃掉, 吸盘, 章鱼, 朋友, 两, 朋友们, 聚一, 东翼, 到达, 爱, 配上, 熟成, 那种, 味道, 大厨, 口感, 餐厅, 拉米, 四溢, 件, 意大利, 排, 酒店, 火腿, 旁, 浓郁, 肉汁, 在内, 火喉, 好吃, 排, 餐时, 适合, 柠檬汁, 餐厅, 腿, 油香, 原能, 牛扒, 餐桌, 藏酒库, 份, 面包, 皮披萨, 香气, 两, 气氛, 两, 感觉, 香气, 聚会, 作, 骨髓, 毛猪, 骨肉, 味道, 软滑, 时, 杯, 美酒, 酒单, 面包, 香, 住口, 土豆, 猪火, 骨胶, 牛骨, 披萨皮, 兴趣, 手工, 脆脆, 菜吃, 文化, ....., 得名, 搭配, 牛, 美食, 开放式, 湿润, 配搭, 分享, 口水, 脆脆, 似, 橄榄油, 牛魔王, 牛扒, 装潢, 客人, 外, 好友, 沙律, 法国, 沙律, 芝士, 战斧, 流, 肉扒, 点独, 吃, 漂亮, 中, 错过, 厨们, 芝士, 次, 未, 票价, 菜(, 服务员, 口感, 新鲜, 时, 骨头, 走到, 空间感, 用餐, 好吃, 提拉米苏, 吃, 新鲜, 调制, 沙律, 菜), 制作, 土豆, 滋味, 华丽, 心果, 厨房&#125;<br></code></pre></td></tr></table></figure><blockquote><p>emmmmmm，感觉上分词效果一般……中文停用词不是每个都被消除了，最终结果中还存在不少无意义的单一文字，且部分名词被划分开（如：“战斧牛排”被拆分为“战斧”+“牛排”）</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>学习</tag>
      
      <tag>NLP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>多项式特征的二分类次数确定问题</title>
    <link href="/2023/01/06/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%B9%E5%BE%81%E7%9A%84%E4%BA%8C%E5%88%86%E7%B1%BB%E6%AC%A1%E6%95%B0%E7%A1%AE%E5%AE%9A%E9%97%AE%E9%A2%98/"/>
    <url>/2023/01/06/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%B9%E5%BE%81%E7%9A%84%E4%BA%8C%E5%88%86%E7%B1%BB%E6%AC%A1%E6%95%B0%E7%A1%AE%E5%AE%9A%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<blockquote><p><strong>问题描述：</strong><br>已知六个特征（记作$X_1,X_2…X_6$），取值为（-2,2），均值接近0（约-0.01），方差接近1（约1.15），设有函数$Y=a_0+a_1X^{b_1}_1+a_2X_2^{b_2}+…+a_6X_6^{b_6}$（假设最高项次数小于10），对Y做Sigmoid(Y)函数处理，输出为0/1（二分类），现有1000个样本（Train.txt：900作为训练集，100作为测试集），求矩阵a和b<br>限制：不使用神经网络和深度学习，主要支撑库为numpy</p></blockquote><p>$Sigmoid(Z)=\frac{1}{1+e^{-Z}}$</p><blockquote><p>实际结果：指数依次为0 4 2 3 1 5 6(第一个0为代表第一位为常量，用做偏移)<br>在已知次数的情况下，笔者梯度下降准确率为98.99%（全局），100%（测试集）<br>所用权重为：</p></blockquote><figure class="highlight plaintext"><figcaption><span>Text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Plain">a0=-1.414120707795622245e+01,b0=0<br>a1=9.836514438332992771e-01,b1=4<br>a2=2.380517972559514028e+00,b2=2<br>a3=7.800843335621133745e-01,b3=3<br>a4=-7.085426102987223196e+00,b4=1<br>a5=-1.099617181010096756e+00,b5=5<br>a6=3.408382709960854906e-01,b6=6<br></code></pre></td></tr></table></figure><hr><hr><blockquote><p><strong>初步想法和思路：</strong></p></blockquote><ul><li><p>思路一：暴力循环</p><ul><li><p>遍历次数所有可能，对每一可能下进行机器学习梯度下降确定系数</p></li><li><p>问题：</p><ul><li>复杂度过高：共计$10^6$种可能组合（可以做优化，但指数级别复杂度不变），对每一种可能做机器学习不现实（单次耗时约10s）</li></ul></li></ul></li><li><p>思路二：最简单，也是暂时唯一验证的可行方式：试！</p><ul><li><p>每一项拆开，即设Ni为Xi的指数，从1~10进行遍历，保持其他项不变（形如：$Y=a_0+a_1X^{n}_1+1<em>X_2+…+1</em>X_6$，或将系数设置为0等）,理应在符合目标时拥有最高的准确率。重复六次，完成对指数的确定后，再进行梯度下降对系数进行学习。这种方式最多只需要60次确定指数。</p></li><li><p>问题</p><ul><li><p>一：如果不存在最高项次数小于10这一条件，我们无从谈起</p></li><li><p>二：实际上，对于形如这样的多项式Z = X+Y+T，排除Y和T，仅仅依靠离散点（如果连续或拥有无穷多样本点可行），我们无法证明Z和X之间满足什么关系（只看这两个变量很可能求出来没有相关性，如本题），即这种思路在数学逻辑上不完备，本题适用，可能在别的场景下不适用</p></li></ul></li><li><p>此外：</p><ul><li>此题适用，但必须说明，我们最终试验得到的最优取值，往往不止一个，我们会发现在某些特征的测试下，准确率非常接近，考虑到机器学习的误差，我们不能依靠细微的差距判断真正的次数，最终还需要再做判断</li></ul></li></ul></li><li><p>思路三：直接对全体进行梯度下降，学习a和b两个未知量</p><ul><li><p>问题：</p><ul><li><p>一：两者梯度交织，互相制约，互为约束条件</p></li><li><p>二：X取值含负数，这段无法求导，即没有梯度</p><ul><li>可以通过数据处理，全部映射为正数，但这会丢失一个重要数据：次数的奇偶性（Sigmoid函数看重正负而非绝对数值）</li></ul></li></ul></li></ul></li><li><p>思路四：指定系数，对指数梯度下降求解</p><ul><li><p>指定系数（如全为1），对$Y=a_0+X^{b_1}_1+X_2^{b_2}+…+X_6^{b_6}$这个函数进行梯度下降。大概率在指数与函数相同时准确率最高（我们认为指数比系数对结果影响更大）。</p></li><li><p>问题：</p><ul><li><p>一：X取值含负数，这段无法求导，更没有梯度一说</p><ul><li><p>可以通过数据处理，全部映射为正数，但这会丢失一个重要数据：次数的奇偶性（Sigmoid函数看重正负而非绝对数值）</p></li><li><p>实际测试结果结果相差过大，与实际几乎无关系</p></li></ul></li><li><p>二：系数怎么指定？</p><ul><li>全为1一定不会有好结果，如上所述，这会忽略特征的正负性，这对Sigmoid非常重要</li></ul></li></ul></li><li><p>分析：</p><blockquote><p>这种方法几乎一定有问题，不考虑学习率、次数为整数等细节，单从逻辑三段论上说，我们的假设“指数比系数对结果影响更大”这一条本身就有问题，我们的特征取值本身较小（-2,2），而实际上系数存在14以上的数值，在很多情况下“指数不比系数对结果影响大”</p></blockquote></li></ul></li><li><p>思路五：对三和四的结合优化</p><ul><li><p>先分析单一特征，得到正负相关性，在正负相关性的作用下进行如三的处理</p></li><li><p>问题：</p><ul><li>对于形如这样的多项式Z =X+Y+T，排除或固定Y和T，我们很可能发现证明Z和X之间满足什么关系，在Pearson相关性分析中，我们会发现他们不含有相关性（笔者认为主要原因是最终输出为0/1的离散点，对每一个特征每一个次方值测试全部“不相关”）</li></ul></li></ul></li></ul><blockquote><p><strong>分析：</strong></p></blockquote><ul><li><p>笔者认为，在判断次数这一问题上，主要难点在于我们使用的不是原始数据，而是经过了Sigmoid函数处理后的参数，Sigmoid函数将连续数据变为离散，这一步损失太大，也就直接导致了函数空间过大，相关性分析表示无相关性，否则我们完全可以直接最小二乘法拟合曲线……</p></li><li><p>可以尝试的想法：</p><ul><li><p>使用元学习单独对指数部分进行处理，因为已知为多项式函数，完全可以仿照现有模型自行仿造相似模型对元学习进行训练（不过如果采用这种方式，不如直接神经网络或深度学习让他直接输出0/1的结果……）</p></li><li><p>补充上述想法：有意义，他使得模型具有可解释性</p></li></ul></li></ul><hr><blockquote><p>后记：<br>本来以为是一个很简单的问题，没想到这么棘手，这几天推了好几遍公式，也尝试不同的数据处理和激活函数，但都不能解决本质问题……甚至还想过能不能将0/1倒推回离散的值（反正是可行解之一），也查了很多资料和文献，都没有发现想要的……现在做基础研究的成果比大热方向少太多了……之后会多看看数学方向，是否有更好的处理方法，在此留作记录</p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>学习</tag>
      
      <tag>未解决</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SVM下条件极值计算无解情况探究</title>
    <link href="/2023/01/06/SVM%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%9E%81%E5%80%BC%E8%AE%A1%E7%AE%97%E6%97%A0%E8%A7%A3%E6%83%85%E5%86%B5%E6%8E%A2%E7%A9%B6/"/>
    <url>/2023/01/06/SVM%E4%B8%8B%E6%9D%A1%E4%BB%B6%E6%9E%81%E5%80%BC%E8%AE%A1%E7%AE%97%E6%97%A0%E8%A7%A3%E6%83%85%E5%86%B5%E6%8E%A2%E7%A9%B6/</url>
    
    <content type="html"><![CDATA[<blockquote><p>SVM下条件极值计算，二维坐标系下，偏导结果为两条平行直线致无解情况，原因探究</p></blockquote><h1 id="三点情况"><a href="#三点情况" class="headerlink" title="三点情况"></a>三点情况</h1><ul><li>结果：当且仅当三点共线时无解</li></ul><hr><ul><li><p>证明：</p><ul><li><p>设存在三点$(x_1,y_1),(x_2,y_2),(x_3,y_3)$，分别为positive，positive，negative，即有$\lambda_1=1,\lambda_2=1,\lambda_3=-1$ 和 $y_1+y_2=y_3$</p><p>$ \begin{equation}<br>\begin{split}<br>\mathcal{J}(\boldsymbol{\lambda})<br> &amp;=\frac{1}{2} \sum_{i=1}^N \sum_{j=1}^N \lambda_i \lambda_j y^{(i)} y^{(j)}\left(\boldsymbol{x}^{(i)}\right)^T \boldsymbol{x}^{(j)}-\sum_{i=1}^N \lambda_i\\<br>&amp;=1/2[(x_1^2+y_1^2) \lambda_1^2+(x_1x_2+y_1y_2)\lambda_1\lambda_2-(x_1x_3+y_1y_3)\lambda_1\lambda_3\\<br>&amp;\ \ +(x_2^2+y_2^2) \lambda_2^2+(x_1x_2+y_1y_2)\lambda_1\lambda_2-(x_2x_3+y_2y_3)\lambda_2\lambda_3\\<br>&amp;\ \ +(x_3^2+y_3^2) \lambda_3^2-(x_2x_3+y_2y_3)\lambda_2\lambda_3-(x_2x_3+y_2y_3)\lambda_1\lambda_3]\\<br>&amp;\ \ -\lambda_1-\lambda_2-\lambda_3\\<br>&amp;=1/2[(x_1^2+y_1^2) \lambda_1^2+(x_2^2+y_2^2) \lambda_2^2+(x_3^2+y_3^2) \lambda_3^2\\<br>&amp;\ \ +2(x_1x_2+y_1y_2)\lambda_1\lambda_2<br>+2(x_1x_3+y_1y_3)\lambda_1\lambda_3<br>-2(x_2x_3+y_2y_3)\lambda_2\lambda_3]\\<br>&amp;\ \ -\lambda_1-\lambda_2-\lambda_3\\<br>\end{split}<br>\end{equation} $</p><p>由 $y_1+y_2=y_3$，将$y_3$带入消去：</p><p>$\begin{equation}<br>\begin{split}<br>\mathcal{J}(\boldsymbol{\lambda})=&amp;1/2[(x_1^2+y_1^2+x_3^2+y_3^2-2x_1x_3-2y_1y_3)\lambda_1^2\\<br>&amp;+(x_2^2+y_2^2+x_3^2+y_3^2-2x_2x_3-2y_2y_3)\lambda_2^2\\<br>&amp;+2(x_3^2+y_3^2+x_1x_2+y_1y_2-x_1x_3-y_1y_3-x_2x_3-y_2y_3)\lambda_1\lambda_2]\\<br>&amp; -2\lambda_1-2\lambda_2\\<br>=&amp;1/2[((x_1-x_3)^2+(y_1-y_3)^2)\lambda_1^2\\<br>&amp;+((x_2-x_3)^2+(y_2-y_3)^2))\lambda_2^2\\<br>&amp;+2((x_3-x1)(x_3-x_2)+(y_3-y_1)(y_3-y_2))\lambda_1\lambda_2]\\<br>&amp; -2\lambda_1-2\lambda_2\\<br>\end{split}<br>\end{equation}$</p><p>对此分别对$\lambda_1，\lambda_2$求偏导</p><script type="math/tex; mode=display">\begin{equation}\begin{split}\frac{\partial \mathcal{J}(\lambda) }{ \partial \lambda_1} =& ((x_1-x_3)^2+(y_1-y_3)^2)\lambda_1\\+&[(x_3-x_1)(x_3-x_2)+(y_3-y_1)(y_3-y_2)]\lambda_2 -2\end{split}\end{equation}</script><p>$\begin{equation}<br>\begin{split}<br>\frac{\partial \mathcal{J}(\lambda) }{ \partial \lambda_2} =&amp; ((x_2-x_3)^2+(y_2-y_3)^2)\lambda_1\+&amp;[(x_3-x_1)(x_3-x_2)+(y_3-y_1)(y_3-y_2)]\lambda_1 -2<br>\end{split}<br>\end{equation}$</p><p>令式(3)(4)为0，可求出其条件极值，显然，当两式平行时无解。故令式(3)(4)为0，且斜率相等，联立求解可得：</p><p>$\begin{equation}<br>\begin{split}<br>\frac{y_3-y_1}{x_3-x_1}=\frac{y_3-y_2}{x_3-x_2}<br>\end{split}<br>\end{equation}$</p><p>上式表示过点1,3直线的斜率与过点2,3的直线的斜率相等，<strong>显然其三点共线</strong></p></li></ul></li><li><p>验证：</p><ul><li>以点(1,1)(2,2)(3,3)为例（三点共线），分别为positive，positive，negative</li></ul><p>$\begin{equation}<br>\begin{split}<br>\mathcal{J}(\boldsymbol{\lambda})=4\lambda_1^2+\lambda_2^2+4\lambda_1\lambda_2-2\lambda_1-2\lambda_2<br>\end{split}<br>\end{equation}$</p><p>$\begin{equation}<br>\begin{split}<br>\frac{\partial \mathcal{J}(\lambda) }{ \partial \lambda_1} =8\lambda_1+4\lambda_2-2<br>\end{split}<br>\end{equation}$</p><p>$\begin{equation}<br>\begin{split}<br>\frac{\partial \mathcal{J}(\lambda) }{ \partial \lambda_2} =4\lambda_1+2\lambda_2-2<br>\end{split}<br>\end{equation}$</p><p>两式平行，无解</p></li></ul><h1 id="四点情况"><a href="#四点情况" class="headerlink" title="四点情况"></a>四点情况</h1><ul><li><p>结果：一定无解</p></li><li><p>证明：</p><ul><li>设存在三点$(x_1,y_1),(x_2,y_2),(x_3,y_3),(x_4,y_4)$，分别为positive，positive，negative，negative，即有$\lambda_1=1,\lambda_2=1,\lambda_3=-1,\lambda_4=-1$ 和 $y_1+y_2=y_3+y_4$（计算方式同上，具体计算细节见附录）</li><li>为计算简洁，另$X_{ij}=x_i-x_j,Y_{ij}=y_i-y_j$，这里消去$\lambda_4$</li><li>分别对$\lambda_1，\lambda_2，\lambda_3$求偏导</li></ul><p>$\begin{equation}<br>\begin{split}<br>\frac{\partial \mathcal{J}(\lambda) }{ \partial \lambda_1} =&amp; (X_{14}^2+Y_{14}^2)\lambda_1+(X_{14}X_{24}+Y_{14}Y_{24})\lambda_2-(X_{14}X_{34}+Y_{14}Y_{34})\lambda_3-2<br>\end{split}<br>\end{equation}$</p><p>$\begin{equation}<br>\begin{split}<br>\frac{\partial \mathcal{J}(\lambda) }{ \partial \lambda_2} =&amp; (X_{24}^2+Y_{24}^2)\lambda_2+(X_{14}X_{24}+Y_{14}Y_{24})\lambda_1-(X_{24}X_{34}+Y_{24}Y_{34})\lambda_3-2<br>\end{split}<br>\end{equation}$</p><p>$\begin{equation}<br>\begin{split}<br>\frac{\partial \mathcal{J}(\lambda) }{ \partial \lambda_3} =&amp; (X_{34}^2+Y_{34}^2)\lambda_3-(X_{14}X_{34}+Y_{14}Y_{34})\lambda_1-(X_{24}X_{34}+Y_{24}Y_{34})\lambda_2-2<br>\end{split}<br>\end{equation}$</p><p>使用系数行列式：</p><p>$\left |\begin{array}{cccc}<br>X_{14}^2+Y_{14}^2 &amp;X_{14}X_{24}+Y_{14}Y_{24}   &amp; -(X_{14}X_{34}+Y_{14}Y_{34}) \\<br>X_{14}X_{24}+Y_{14}Y_{24} &amp;X_{24}^2+Y_{24}^2 &amp; -(X_{14}X_{34}+Y_{14}Y_{34})  \\<br>-(X_{14}X_{34}+Y_{14}Y_{34}) &amp; -(X_{24}X_{34}+Y_{24}Y_{34}) &amp;X_{34}^2+Y_{34}^2 \\<br>\end{array}\right|$</p><p>上式计算后结果为0，即函数无解（具体计算方式为，第二三行分别减去第一行的倍数消去$\lambda_1$,得到仅含$\lambda_2，\lambda_3$的两个计算式，这两式平行，斜率如下，计算细节见附录）</p><p>$\begin{equation}<br>\begin{split}<br>\frac{X_{14}Y_{24}-X_{24}Y_{14}}{X_{14}Y_{14}-X_{14}Y_{34}}<br>\end{split}<br>\end{equation}$</p><blockquote><p>综上所述，其一定求出结果为无解</p></blockquote></li></ul><h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><p><img src="https://picture-for-mark.oss-cn-hangzhou.aliyuncs.com/img/IMG_20221102_220253.jpg" alt="IMG_20221102_220253"></p><blockquote><p>上式计算并消去$\lambda_4$进行求导</p></blockquote><p><img src="https://picture-for-mark.oss-cn-hangzhou.aliyuncs.com/img/IMG_20221102_220348.jpg" alt="IMG_20221102_220348"></p><blockquote><p>上式计算一个式子的斜率，另一边方法相同</p></blockquote><hr><blockquote><p>关于“无解”的数学解释：</p></blockquote><ul><li><p>在限定条件取值范围内不存在极值点，从二维坐标系来看指函数单调，即仅存在边界处的最值点</p></li><li><p>从直觉上感觉，所使用的点越多，$\lambda$之间交织的限制越严格，越难以得到可行解，如使用两个点一定有解，三点仅在共线时无解，四点始终无解（猜测5及以后也无解……~）</p></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
